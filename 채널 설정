#!/bin/bash

# channels.json 파일 생성
echo "[" > channels.json

# 사용자로부터 입력 받기
channels_count=0
while true; do
    echo "id name output_dir 형식으로 채널 정보를 입력하십시오"
    echo "완료되면 'done'을 입력하세요:"
    read -r id name output_dir

    # 'done'을 입력하면 반복문 종료
    if [ "$id" == "done" ]; then
        break
    fi

    # identifier 할당
    identifier="ch$((++channels_count))"

    # 입력 받은 정보를 JSON 형식으로 channels.json에 추가
    echo "{\"id\": \"$id\", \"name\": \"$name\", \"output_dir\": \"$output_dir\", \"identifier\": \"$identifier\"}," >> channels.json
done

# 마지막 쉼표 제거 및 파일 마무리
sed -i '$s/,$//' channels.json
echo "]" >> channels.json

echo "channels.json 파일이 생성되었습니다."

# delays.json 파일 생성
echo "{" > delays.json

# 각 채널에 대해 1초 간격으로 시작 딜레이 설정 추가
for ((i=1; i<=channels_count; i++)); do
    echo "  \"ch$i\": $((i-1))," >> delays.json
done

# 마지막 쉼표 제거 및 파일 마무리
sed -i '$s/,$//' delays.json
echo "}" >> delays.json

echo "delays.json 파일이 생성되었습니다."

